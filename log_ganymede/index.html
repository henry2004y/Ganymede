<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/Ganymede/libs/katex/katex.min.css"> <link rel=stylesheet  href="/Ganymede/css/franklin.css"> <link rel=stylesheet  href="/Ganymede/css/poole_hyde.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/Ganymede/assets/favicon.png"> <title>Ganymede Log</title> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <h1><a href="/Ganymede/">CSEM</a></h1> <p class=lead >Our attempts to understand nature.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/Ganymede/">Home</a> <a class="sidebar-nav-item active" href="/Ganymede/log_ganymede/">Log</a> <a class="sidebar-nav-item " href="/Ganymede/simulations_ganymede/">OverView</a> <a class="sidebar-nav-item " href="/Ganymede/extra/">Extra</a> <a class="sidebar-nav-item " href="/Ganymede/galileo/">Observation</a> <a class="sidebar-nav-item " href="/Ganymede/compilation/">Compilation</a> <a class="sidebar-nav-item " href="/Ganymede/swmf/">Run in Action</a> <a class="sidebar-nav-item " href="/Ganymede/ulfwaves/">ULF Waves</a> <a class="sidebar-nav-item " href="/Ganymede/shocks/">Shocks</a> <a class="sidebar-nav-item " href="/Ganymede/reconnection/">Reconnection</a> <a class="sidebar-nav-item " href="/Ganymede/kaw/">Kinetic Alfvén Waves</a> </nav> <p>&copy; Hongyang Zhou.</p> </div> </div> <div class="content container"> <div class=franklin-content ><h1 id=ganymede_research_log ><a href="#ganymede_research_log" class=header-anchor >Ganymede Research Log</a></h1> <div class=franklin-toc ><ol><li><a href="#lessons">Lessons</a><li><a href="#products">Products</a><li><a href="#physics">Physics</a><ol><li><a href="#alfvén_wing">Alfvén wing</a><li><a href="#ionosphere">Ionosphere</a><li><a href="#mhd">MHD</a><li><a href="#resistivity">Resistivity</a><li><a href="#fit_to_the_dipole_moments_and_induced_magnetic_field">Fit to the dipole moments and induced magnetic field</a><li><a href="#electron_pressure_equation">Electron pressure equation</a><li><a href="#reconnection_rate">Reconnection rate</a><li><a href="#generation_of_magnetic_field">Generation of magnetic field</a><li><a href="#magnetic_field_topology_classification">Magnetic field topology classification</a><li><a href="#gravity">Gravity</a><li><a href="#why_is_it_challenging">Why is it challenging?</a></ol><li><a href="#unit_conversion">Unit Conversion</a><li><a href="#coordinate_system">Coordinate System</a><li><a href="#numerical_schemes">Numerical Schemes</a><ol><li><a href="#fully_explicit_method">Fully explicit method</a><li><a href="#semi-implicit_method">Semi-implicit method</a><li><a href="#div_b_cleaning">Div B cleaning</a><li><a href="#hall_mhd">Hall MHD</a></ol><li><a href="#inner_bcs">Inner BCs</a><ol><li><a href="#cell_vs_face">Cell .vs. face</a><li><a href="#mhd_boundary_conditions">MHD boundary conditions</a><li><a href="#core_boundary_condition">Core boundary condition</a></ol><li><a href="#solve_resisivity_numerically">Solve Resisivity Numerically</a><ol><li><a href="#better_inner_bc">Better Inner BC</a></ol><li><a href="#outer_bcs">Outer BCs</a><li><a href="#local_timestepping_vs_time-accurate">Local Timestepping .vs. Time-accurate</a><li><a href="#mhd_vs_pic">MHD .vs. PIC</a><li><a href="#pc_scheme">PC Scheme</a><li><a href="#speed_of_light">Speed of Light</a><li><a href="#g2">G2</a><li><a href="#g29">G29</a><li><a href="#gmpc_coupling">GM/PC Coupling</a><ol><li><a href="#charge-mass_ratio">Charge-mass ratio</a><li><a href="#observation_on_the_first_coupled_run">Observation on the first coupled run</a><li><a href="#effect_of_pic_resolution">Effect of PIC resolution</a></ol><li><a href="#comparison_between_g8_and_g28">Comparison Between G8 and G28</a><li><a href="#magnetopause">Magnetopause</a><li><a href="#reconnection_ftes_and_flux_ropes">Reconnection, FTEs and Flux Ropes</a><ol><li><a href="#local_reconnection_rate">Local reconnection rate</a><li><a href="#analytical_estimation">Analytical Estimation</a></ol><li><a href="#potential_drop">Potential Drop</a><li><a href="#neutral_exchange_rates">Neutral Exchange Rates</a><li><a href="#ulf_wave">ULF Wave</a><li><a href="#kh_instability">KH Instability</a></ol></div> <h2 id=lessons ><a href="#lessons" class=header-anchor >Lessons</a></h2> <ul> <li><p>Collect everything into organized files and write automated scripts for future reference.</p> <li><p>Before you test something new, make sure you can revert to the previous method. A proper version control tool is invaluable.</p> <li><p>Be careful about unit and coordinate system conversions.</p> <li><p>When it is a multi-variable problem, do not rush to conclusions&#33;</p> <li><p>Simplify tests whenever there are too many things together. Just like the design of unit tests: one thing at a time.</p> </ul> <h2 id=products ><a href="#products" class=header-anchor >Products</a></h2> <p>The years of research results in many bug fixes in BATSRUS and improvements on postprocessing and visualization. The codes I write for processing and analyzing both observation and simulation results can be found at <a href="https://github.com/henry2004y/VisAnaMatlab">VisAnaMatlab</a> and <a href="https://github.com/henry2004y/VisAnaJulia">VisAnaJulia</a>.</p> <h2 id=physics ><a href="#physics" class=header-anchor >Physics</a></h2> <ul> <li><p>Largest moon of Jupiter &#40;also the largest moon in the solar system&#41;, \(R_G=2634\text{km}\). Only moon to have internal magnetic field; dipole axis nearly antiparallel to spin axis.</p> <li><p>Orbits lie very close to the rotation equator of Jupiter but tilted with respect to Jupiter&#39;s plasma sheet. Synodic period: 10.5 h. \(15R_J=15\times 71400\text{km}\); no bow shock</p> <li><p>6 flybys of the Galileo spacecraft.</p> <ul> <li><p>G1,G2: measured \(\mathbf{B}\) significantly increased near Ganymede, inferring an intrinsic magnetic field; sharp rotations in \(\mathbf{B}\) across the separatrices between external and connected field lines indicating strong localized currents. * Changes in energetic ion anisotropy signatures detected by Energetic Particle Detector &#40;EPD&#41; showed that magnetosphere significantly slows the ambient Jovian plasma in regions extending to \(\sim R_G\) away from Ganymede along the Jovian field lines connected to the moon. &#40;Here we have inferred \(\mathbf{B}\) info.&#41;</p> <li><p>Detected wave modes further comfirms the existence of magnetosphere. upper hybrid resonance \(\rightarrow\) electron density \(n_e\sim 400 \text{cm}^{-3}\) above the surface &#40;i.e. in the ionosphere&#41;, with a scale height of \(600\text{km}\approx 0.23 R_G\).</p> </ul> <li><p>Plasma Analyzers &#40;PLS&#41;: outflowing ions from high latitude ionosphere, indicating polar wind. This equipment is not so trustworthy.</p> <li><p>Hubble Space Telescope: OI airglow, aurora</p> </ul> <h3 id="alfvén_wing"><a href="#alfvén_wing" class=header-anchor >Alfvén wing</a></h3> <p>Refer to the original paper. Alfvén wings are a consequence of the interaction between the flow velocity and an Alfvén wave. As a magnetic field encounters an obstacle and starts to bend, Alfvén waves are launched along the field-lines away from that point. These Alfvén waves propagate along the magnetic field line with the speed \(V_A=B/\sqrt{\mu_0 \rho}\), where \(B\) is the magnetic field strength, and \(\rho\) is the plasma mass density. In addition, the plasma still advects the magnetic field with a given velocity \(V\) . The Alfvén wave, therefore, travels with an angle \(\theta=\tan^{-1}({M_A}^{-1})\), where \(M_A\) is the Alfvén Mach number, defined by \(M_A=V /V_A\) <a href="https://doi.org/10.1029/JA085iA03p01171">Neubauer, 1980</a>. The flow diverts around the obstacle and forms two tubes &#40;above and below&#41; the object in which the flow characteristics of the plasma are altered significantly from the surrounding medium. This cavity is the low density Alfvén wing.</p> <h3 id=ionosphere ><a href="#ionosphere" class=header-anchor >Ionosphere</a></h3> <p>Whether or not Ganymede has a real ionosphere is still debatable. In 2001, researchers published a paper with a conclusion that Ganymede has a bound ionosphere composed mainly of molecular oxygen ions in the polar regions and of atomic oxygen ions at low latitudes and that protons are absent everywhere. Their prediction is that Ganymede is surrounded by a corona of hot oxygen atoms.</p> <p>From PWS measurements during the G1 and G2 flyby, <img src="/Ganymede/assets/PWS_e_density.png" alt=""></p> <p>The common slope of the first mentioned triad corresponds to a scale height of 600 km and a surface density of about 400\(\text{cm}^{-3}\). This is well below the upper limit of \(4\times10^3 \text{cm}^{-3}\) obtained by &#91;Kliore, 1998&#93; in the radio occultation observation.</p> <p>Consider two separate regions on the surface of Ganymede, the polar cap region, for which the latitude \(\lambda>45^o\) and the lower latitude regions equatorward of this limit. Neutral temperature maps published by <a href="https://science.sciencemag.org/content/274/5286/389/tab-figures-data">Orton&#43;, 1996</a> show a range of temperatures from about 150 K in the subsolar equatorial zone to below 90 K near the poles and in the pre-dawn sector. The \(O_2\) scale height estimated in <a href="https://doi.org/10.1016/S0032-0633&#40;00&#41;00154-9">Eviatar&#43;, 2000</a> is only 21.5 km. The estimated polar cap ion density is</p> \[\begin{aligned} n_{O_2^+} &= 2.2 \times 10^3\,\text{cm}^{-3}, \\ n_{O_2} &= 3.5 \times 10^6\,\text{cm}^{-3}, \\ n_{O^+} &= 3.3 \times 10^2\,\text{cm}^{-3}, \\ n_{O^} &= 1.7 \times 10^6\,\text{cm}^{-3}, \\ \end{aligned}\] <p>In the closed field line region, the magnetospheric thermal plasma density can be expected to be very low in this region, because of the inaccessibility of closed drift paths to injected Jovian particles and the paucity of local plasma sources. In the low-latitude regions of Ganymede, the dayside temperature can be as high as 140–150 K.<sup id="fnref:1"><a href="#fndef:1" class=fnref >[1]</a></sup></p> <p><table class=fndef  id="fndef:1"> <tr> <td class=fndef-backref ><a href="#fnref:1">[1]</a> <td class=fndef-content >High-low is always relative. Keep in mind that this \(10^2\) K temperature is in fact very very low compared to the background energetic ions that contribute most of the pressure&#33; </table> Mass loading/loss:</p> <ul> <li><p><strong>photo-ionization</strong></p> <li><p><strong>dissociative recombination</strong></p> <li><p><strong>electron impact</strong></p> </ul> <h3 id=mhd ><a href="#mhd" class=header-anchor >MHD</a></h3> <p>Magnetohydrodynamics &#40;MHD&#41; equations are presently the only system available to self-consistently describe large-scale dynamics of space plasmas, and numerical MHD simulations has enabled us to capture the basic structures of the solar wind plasma flow and transient phenomena. The modern MHD codes can successfully solve both in time accurate and steady state problems involving all kinds of discontinuities. Different from the usual computational fluid mechanics, the MHD scheme has to be designed so as to guarantee the divergence free constraint of the magnetic field in two or three-dimensional MHD calculations. It is well-known that simply transferring conservation law methods for the Euler to the MHD equations can not be supposed to work at default in maintaining the divergence-free of magnetic field. The \(\nabla\cdot\mathbf{B}\) error accumulated during the calculation may grow in an uncontrolled fashion, which can result in unphysical forces and numerical instability &#91;Tóth, 2000; Jiang&#43;, 2012a&#93;<sup id="fnref:2"><a href="#fndef:2" class=fnref >[2]</a></sup></p> <table class=fndef  id="fndef:2"> <tr> <td class=fndef-backref ><a href="#fnref:2">[2]</a> <td class=fndef-content >R.L Jiang at Nanjing University has an AMR MHD code which should be similar to BATSRUS. </table> <h3 id=resistivity ><a href="#resistivity" class=header-anchor >Resistivity</a></h3> <p>Resistivity calculation: I calculate the peak resistivity based on the estimation that within range \(r\in[r_G,1.05r_G]\), the total conductance is \(2S\), which means the resistance is \(0.5\Omega\).</p> \[ R=\eta \frac{l}{A}=\int_{1R_G}^{1.05R_G}\eta \frac{dr}{4\pi r^2} \] <p>Assume that the resistivity changes linearly, \(\eta=Ar+B\),</p> \[\begin{aligned} &A\cdot 1R_G + B = \eta_H, \\ &A\cdot 1.05R_G + B = 0 \\ \Rightarrow &A=-20\eta_H/R_G,\ B=21\eta_H \end{aligned}\] <p>So in normalized radius \(r^\prime\),</p> \[ \eta=-20\eta_H r^\prime +21\eta_H. \] \[\begin{aligned} R&=\frac{1}{4\pi}\int \frac{\eta(r)}{r^2}dr =\frac{1}{4\pi}\int \frac{Ar+B}{r^2}dr=\frac{1}{4\pi}\Big[ A\int\frac{dr}{r}+B\int \frac{dr}{r^2} \Big] \\ &=\frac{1}{4\pi}\Big[ A\ln{r}-B\frac{1}{r}\Big]\big|_{1}^{1.05}=0.5\Omega \end{aligned}\] \[\begin{aligned} \frac{1}{4\pi}\Big[ -20\frac{\eta_H}{R_G}\ln{21/20}-21\frac{\eta_H}{R_G}(\frac{1}{1.05}-1)\Big]=0.5 \\ \Rightarrow \eta_H=2\pi*R_G/(-20\ln{1.05}-21/1.05+21)=6.3334\times10^8 \Omega\cdot\text{m} \end{aligned}\] <p>However, in BATSRUS, the units of resistivity is \(\eta/\mu_0\),</p> \[ \eta_H = \frac{6.334\times10^8}{4\pi\times10^{-7}}=5.04\times10^{14} \] <p>Inside the body,</p> \[\begin{aligned} \mathbf{j} = \sigma (\mathbf{E}+\cancel{\mathbf{u}\times\mathbf{B}}) \\ \frac{\partial\mathbf{B}}{\partial t}=-\nabla\times\mathbf{E}=-\nabla\times(\eta\mathbf{j})=-\nabla\times(\frac{\eta}{\mu_0}\nabla\times\mathbf{B}) \end{aligned}\] <p>If \(\eta=const.\), then</p> \[ \mu_0 \sigma\frac{\partial\mathbf{B}}{\partial t}=\nabla^2\mathbf{B} \] <p>This is same as shown by Eq.&#40;1&#41; of Zimmer&#39;s Europa paper.</p> <p>I have non-uniform resistivity inside the body, so things get complicated.</p> <p>I don&#39;t know if dipole field satisfies \(\nabla^2\mathbf{B}=0\).</p> <p>Outside the body,</p> \[ \frac{\partial\mathbf{B}}{\partial t}=-\nabla\times(\eta\mathbf{j} - \mathbf{u}\times\mathbf{B})=\nabla\times(\mathbf{u}\times\mathbf{B})-\nabla\times(\eta\mathbf{j}) \] <p>The right-hand side is treated in <code>ModFaceFlux</code>.</p> <p>The induction effect of a conducting core. The physical model is that you have a very high conductivity core region and a low conductivity mantle region. Because of the high conductivity of the core, we can treat it as a perfect conducing core with a dipole field generated from a dynamo. If you set \(\eta=0\) in the mantle region &#40;low resistivity&#41;, the B field is then fixed in the mantle so that it acts like a perfect conducting sphere with radius \(r=1R_G\). Xianzhe mentioned in his Mercury paper a comparison between a conducting core and a purely resistive body &#40;without a conducting core&#41;. My understanding is as follows: if you reach a steady state with a given resistivity profile, you get a curl-free steady B &#40;at least for the mantle region&#41;.If then you use another resistivity profile to get a new steady state, it is still unclear what resistivity do in the process. What Xianzhe did in the Mercury simulation is that &#40;at least I believe&#41; he continued the steady state solution that is reached by including a conducting core in two ways: one still with a conducting core &#40;by keeping the resistivity profile as shown in the plot&#41; and a pressure enhancement, and the other without a conducting core &#40;by setting very high resistivity near the surface of the core?&#41; In this way you cannot get strong current near the core surface so no induction effect. You see what I mean? The absolute resistivity value may be unimportant in a steady state solution.</p> <p>Yuxi said he once asked Xianzhe about why we are not considering induction effect for Earth and Jupiter, for example. Xianzhe responded that the reason is the core of Earth is relatively small comparing to its size of magnetosphere.</p> <p>Based on my understanding here, I need to modify my resistivity profile at the core boundary. I should extend zero value to about \(0.52R_G\).</p> <h3 id=fit_to_the_dipole_moments_and_induced_magnetic_field ><a href="#fit_to_the_dipole_moments_and_induced_magnetic_field" class=header-anchor >Fit to the dipole moments and induced magnetic field</a></h3> <p>The induced dipole field is produced as a result of interaction between the time-varying Jovian magnetic field and the high conducting core. See the Europa paper. In our simulations, the upstream conditions are set to <code>fixed</code>, so this effect is missing. As a compensation, we analytically calculate the induced dipole field and add to the intrinsic dipole field.</p> <table><tr><th align=right >Flyby<th align=center >\(M_z\) &#91;nT&#93;<th align=right >\(M_y\) &#91;nT&#93;<th align=right >\(M_x\) &#91;nT&#93;<th align=right >\(B_x^{bk}\) &#91;nT&#93;<th align=right >\(B_y^{bk}\) &#91;nT&#93;<th align=right >\(B_z^{bk}\) &#91;nT&#93;<th align=right >\(v\) &#91;km/s&#93;<th align=right >\(\rho\) \([\mathbf{amu}/\mathbf{cm}^3]\)<th align=right >\(P\) &#91;nPa&#93;<tr><td align=right >G1<td align=center >-716.8<td align=right >82.5<td align=right >-24.7<td align=right >6<td align=right >-79<td align=right >-79<td align=right >140<td align=right >28<td align=right >1.9<tr><td align=right >G2<td align=center >-716.8<td align=right >80.0<td align=right >-29.3<td align=right >17<td align=right >-73<td align=right >-85<td align=right >140<td align=right >28<td align=right >1.9<tr><td align=right >G7<td align=center >-716.8<td align=right >14.0<td align=right >-20.9<td align=right >-3<td align=right >84<td align=right >-76<td align=right >130<td align=right >28<td align=right >1.9<tr><td align=right >G8<td align=center >-716.8<td align=right >51.8<td align=right >-18.0<td align=right >-11<td align=right >11<td align=right >-77<td align=right >140<td align=right >56<td align=right >3.8<tr><td align=right >G28<td align=center >-716.8<td align=right >17.0<td align=right >-19.3<td align=right >-7<td align=right >78<td align=right >-76<td align=right >140<td align=right >28<td align=right >1.9<tr><td align=right >G29<td align=center >-716.8<td align=right >84.2<td align=right >-18.4<td align=right >-9<td align=right >-83<td align=right >-79<td align=right >140<td align=right >28<td align=right >1.9</table> <p>From &#91;Kivelson&#43; 2002&#93; Table V, the dipole moments are fitted from G1, G2, and G28. For all the flybys, magnetic fields are fitted as follows:</p> \[\begin{aligned} \alpha = 0.84 \\ M_{x,0}=-h_{1}^1 = -22.2 \text{nT},\quad M_{y,0}=g_{1}^1 = 49.3 \text{ nT},\quad M_{z,0}=g_{1}^0 = -716.8 \text{nT} \\ G1: M_x = M_{x,0} - \alpha*0.5*B_x^{bk} = -24.72 \text{nT},\ M_y = M_{y,0} - \alpha*0.5*B_y^{bk} = 82.47 \text{nT} \\ G2: M_x = M_{x,0} - \alpha*0.5*B_x^{bk} = -29.34 \text{nT},\ M_y = M_{y,0} - \alpha*0.5*B_y^{bk} = 79.96 \text{nT} \\ G7: M_x = M_{x,0} - \alpha*0.5*B_x^{bk} = -20.94 \text{nT},\ M_y = M_{y,0} - \alpha*0.5*B_y^{bk} = 14.02 \text{nT} \\ G8: M_x = M_{x,0} - \alpha*0.5*B_x^{bk} = -17.58 \text{nT},\ M_y = M_{y,0} - \alpha*0.5*B_y^{bk} = 44.68 \text{nT} \\ G28: M_x = M_{x,0} - \alpha*0.5*B_x^{bk} = -19.26 \text{nT},\ M_y = M_{y,0} - \alpha*0.5*B_y^{bk} = 16.54 \text{nT} \\ G29: M_x = M_{x,0} - \alpha*0.5*B_x^{bk} = -18.42 \text{nT},\ M_y = M_{y,0} - \alpha*0.5*B_y^{bk} = 84.16 \text{nT} \end{aligned}\] <p>What I found from this calculation is that \(M_y\) for G8 is off by \(7\,nT\).</p> <p>At some point I questioned the dipole fit. I had an idea of checking the dipole with G2. The box output with <code>ipict&#61;1</code> is the sum of the dipole and background field. Subtract the background field, and you can feel how strong is the dipole. I expect this to be very close to Galileo data. Use this to verify my dipole moments. I also did a dipole test and collected the results in a PDF.</p> <p>There is a point when I get better results with the correct dipole calculation and a different resistivity number.</p> <h3 id=electron_pressure_equation ><a href="#electron_pressure_equation" class=header-anchor >Electron pressure equation</a></h3> <p>After I had partly success with the ideal MHD tests, I moved on to include an independent electron pressure equation into the model. Previously we used a fixed \(P_e/P_i\) ratio 1/5.</p> <p>MHD with Pe and hyperbolic cleaning seems to work fine &#40;even better for steady-state B comparison&#33;&#41;. The ion/electron pressure ratio is larger than 5 inside the magnetosphere</p> <h3 id=reconnection_rate ><a href="#reconnection_rate" class=header-anchor >Reconnection rate</a></h3> <p>How to calculate the reconnection rate? \(\exp{\gamma t}\)</p> <h3 id=generation_of_magnetic_field ><a href="#generation_of_magnetic_field" class=header-anchor >Generation of magnetic field</a></h3> <p>Gabor mentioned to me one thing: electron pressure gradient is a potential possible way of generating magnetic field without the existence of magnetic field. Actually this is discussed a lot in astrophysics and is regarded as one key mechanism of creating magnetic field.</p> <h3 id=magnetic_field_topology_classification ><a href="#magnetic_field_topology_classification" class=header-anchor >Magnetic field topology classification</a></h3> <p>There are two built-in ray tracing schemes in BATSRUS; there is also a field line identification algorithm described in Alex Glocer&#39;s paper. Paul Cassak had a student working on this as his PhD thesis.</p> <p>Using the <code>status</code> variable from BATSRUS&#39;s field tracing, we can identify open/closed field lines.</p> <p>I once spent several days to debug the field line tracing scheme for my Ganymede runs; it turned out that an incorrect setup of the minimum radius led to an infinite loop. On a second thought, the original design of related modules in Fortran is the root cause why these bugs are hard to find.</p> <p>I once thought about the idea of helicity, but soon gave it up:</p> <blockquote> <p>magnetic reconnection can be regarded as a process of conversion between different forms of magnetic helicity, while the total magnetic helicity is conserved in the process &#40;Woltjer 1958; Taylor 1974; Wright \&amp; Berger 1989&#41;.</p> </blockquote> <p>Helicity is a &quot;quasi-conserved&quot; quantity in Hall-Resistive MHD.</p> <ul> <li><p>\(\mathbf{E}^\prime = \mathbf{E} + \mathbf{v}_e\times\mathbf{B}\)</p> <li><p>\(\mathbf{E}^\prime = \mathbf{E} + \mathbf{u}_i\times\mathbf{B}\)</p> <li><p>\(\mathbf{E}^\prime\cdot\mathbf{J}\)</p> <li><p>\(J/B\)</p> <li><p>\(\nabla\cdot\mathbf{v}_e\)?</p> <li><p>\(T\)</p> </ul> <p>None of the above works well in the simulations.</p> <h3 id=gravity ><a href="#gravity" class=header-anchor >Gravity</a></h3> <p>For solving the density diffusion problem at the inner boundary, Gabor suggested turning on gravity. This has little effect on the results.</p> <h3 id=why_is_it_challenging ><a href="#why_is_it_challenging" class=header-anchor >Why is it challenging?</a></h3> <p>Nearly all the approximations and tricks I use in my Ganymede simulation is to deal with the multi-scale problem.</p> <h2 id=unit_conversion ><a href="#unit_conversion" class=header-anchor >Unit Conversion</a></h2> <p>Most studies use SI units. Some old studies use CGS units.</p> <h2 id=coordinate_system ><a href="#coordinate_system" class=header-anchor >Coordinate System</a></h2> <p>Commonly we are using GPhiO coordinate system.</p> <h2 id=numerical_schemes ><a href="#numerical_schemes" class=header-anchor >Numerical Schemes</a></h2> <p>BATSRUS has the option of using conservative scheme or nonconservative scheme. The difference lies in whether we are solving the pressure equation or the energy equation. According to Gabor&#39;s experience, these two behave differently especially for shocks. I have seen that in Ganymede&#39;s case, solving the pressure equation will lead to an increase of density along the Alfvén wing edges, which does not appear when solving the energy equation. Physically, the shock discontinuity is described by the conservation laws. Using a pressure equation indicates that we assume some kind of physical processes, e.g. adiabatic, which may not hold across the discontinuity. The default choice for BATSRUS is to only apply nonconservative scheme near the Earth, which makes sense in this regard.</p> <p>In <a href="https://doi.org/10.1029/2007JA012748">Jia&#43;, 2008</a>, they solved the pressure equation everywhere; in <a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a>, they solved the energy equation everywhere; in <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2016GL068363">Fatemi&#43;, 2018</a>, the hybrid model seems to use pressure equation or equivalence; in <a href="https://doi.org/10.1029/2019JA026643">Zhou&#43;, 2019</a> and <a href="https://doi.org/10.1029/2020JA028162">Zhou&#43;, 2020</a>, I solved the energy equation everywhere.</p> <h3 id=fully_explicit_method ><a href="#fully_explicit_method" class=header-anchor >Fully explicit method</a></h3> <p>If we update everything explicitly, the large density inside the body to reduce large Alfvén speed for timestep calculation.</p> <h3 id=semi-implicit_method ><a href="#semi-implicit_method" class=header-anchor >Semi-implicit method</a></h3> <p>However, with semi-implicit method and solid body this is no longer true.</p> <p>Happened to find that my timestep for the cell inner BC Hall MHD run is incredibly small for the pole region inside \(r=1\), the time step is about \(\sim10^{-6}s\)&#33; Yuxi told me this is because of the resistivity. Remember you need to switch to semi-implicit scheme for time-accurate mode? This is the reason&#33; Also, the smallest timestep shows up in one layer of cells below \(r=1\) when I had coarse axis turned on. Just think about this: things get slowed down at \(r=1\)&#33;</p> <p>Solution: use semi-implicit scheme in both local timestepping and time-accurate mode.</p> <p>Maybe the implicit timestep inside 0.01s is too large? Remember this would effect accuracy, but not stability.</p> <h3 id=div_b_cleaning ><a href="#div_b_cleaning" class=header-anchor >Div B cleaning</a></h3> <p><em>8 wave scheme</em></p> <p><em>Hyperbolic cleaning</em></p> <p>why there&#39;s nonzero flux in the mantle cell at the very first timestep. I found it. <code>Flux_V</code> is nonzero because of <code>#HYPERBOLICDIVB</code>. This is the reason for local extreme inside the mantle. I should read about the original paper about hyperbolic cleaning and Gabor&#39;s paper on solving divB problem.</p> <p>In DivB constaint techniques, there is another simple idea in the literature. Instead of solving the magnetic induction equation alone &#40;3 equations with 3 unknowns&#41;, we can solve two of them and add the \(\nabla\cdot\mathbf{B}=0\) to it. Or in a similar way, we can find the least square fit to the 3 unknowns with 4 equations.</p> <p>Currently there is an inconsistency of \(\nabla\cdot\mathbf{B}\) in the initial condition. No matter how hard you try with hyperbolic cleaning and eight-wave scheme, you cannot get rid of the divergence at the inner boundary&#33; Imagine if you are running with a CT scheme, even though no numerical divergence is being created, you will still suffer from the unphysical initial condition.</p> <h3 id=hall_mhd ><a href="#hall_mhd" class=header-anchor >Hall MHD</a></h3> <p>Yuxi said the reason my face Hall MHD gives wrong solution may be instability. I can try to increase the <code>HallCmaxFactor</code> and decrease the timestep inside \(r=1\).</p> <p><code>HallCmaxFactor</code> also has an effect on the results. If I use \(0\), then the results becomes unstable gradually.</p> <p>I will try to test on the optimal value for these two. I will test on G2 and G8, first the timestep, then the <code>HallCmaxFactor</code>.</p> <h2 id=inner_bcs ><a href="#inner_bcs" class=header-anchor >Inner BCs</a></h2> <h3 id=cell_vs_face ><a href="#cell_vs_face" class=header-anchor >Cell .vs. face</a></h3> <p>At \(r=1R_G\), we have the option of using user-defined cell BC and solid body face BC. The cell BC is developed for mercury as part of the work of including a resistive body. This approach is like a hack into the numerical solver: it overwrites the cell center values below the surface, which is not compatible with the hyperbolic cleaning and the semi-implicit scheme &#40;for some unknown reasons&#41;. This is dangerous and error-prone.</p> <p>On the other hand, Bart introduced <code>#SOLIDBODY</code> command for the solar applications. I took advantage of that and create a face BC at \(r=1R_G\): during the explicit update phase, a face boundary is placed at \(r=1\) so the MHD equations are solved only in region \(r>1\); during the implicit update phase, the face boundary is turned off and the inner boundary is now at the core, and we only solve for \(\eta\mathbf{j}\) term in the magnetic induction equation.</p> <p>The cell BC can be second order while the face BC is only first order. During the initial phase of transitioning from cell to face inner BC, I felt that the face BC is not robust enough. As I become more and more familiar with the method, the advantages of face BC surely makes it a better option than cell BC.</p> <h3 id=mhd_boundary_conditions ><a href="#mhd_boundary_conditions" class=header-anchor >MHD boundary conditions</a></h3> <p>We need to set the boundary conditions for \(\rho,\mathbf{U},\mathbf{B}\) and \(P,Pe\). Currently in BATSRUS, cell boundary can only be applied at real mesh boundaries, and we can only use face boundary inside the mesh domain. Due to the lack of theoretical support, I have to do a lot of tests and numerical experiments.</p> <p>For the density, we use <code>fixed</code> BC with \(\rho=550\) amu/cc. The idea is that we want to mimic a cold dense plasma source. If the density is set too high, all the densities inside the magnetosphere are high, and there&#39;s no density drop across the magnetopause.</p> <p>I once tried a steady state test with surface density down to 100 amu/cc. The magnetic field significantly changed. I can see a plasma cavity at dayside, but the magnetic field comparison becomes worse probably because the inner pressure I set was too large, such that the magnetopause got expanded.</p> <p>Actually one idea to test the density only is to completely remove the magnetic field and focus on the hydrodynamics part.</p> <p>For the high resolution runs &#40;AMR3&#41;, the density peak at dayside near the surface becomes more of an issue. Also, in Hall MHD, even if the Hall region is set to \(r=1.05\), the peak at the tail near the surface becomes another issue. In any case, the flow pattern is consistent with the prescribed boundary condition, but not necessarily be correct in nature.</p> <p><a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a> and <a href="https://doi.org/10.1002/2015JA021997">Toth&#43;, 2016</a> uses <code>float</code> density.</p> <p>For the velocity, we have three choices:</p> <ol> <li><p>absorb, which means that plasma velocity can only goes into the body;</p> <li><p>reflect, or solid, which means that plasma flow cannot penetrate the surface;</p> <li><p>\(\mathbf{B}\) dependent, which means that we remove the plasma velocity parallel to the surface, but keep the perpendicular components.</p> </ol> <p>For the magnetic field, we use <code>float</code> at the surface.</p> <p>For the pressures, we use either <code>float</code> or <code>fixed</code>. I am not sure if fixing both density and pressure will create an overspecified system.</p> <p>If I use float P at r&#61;1, the pressure at the tail near the surface would reach as high as 25 nPa. If I use fixed, then it only reach about 12 nPa. While keeping everything else the same, using fixed pressure has much better magnetic field comparison.</p> <p>On a coarse grid &#40;0.3 million cells&#41;, a bunch of tests are performed. While the third velocity BC can give nice magnetic field comparisons with a proper resistivity, it does not give a physically meaningful plasma flow pattern: there is always a source point on the upstream front, and the flow moves towards the tail at relatively high speed around the flanks. The reflect U BC can give nice flow pattern, but the magnetic field comparison is off due to the fact that the magnetosphere gets expanded.</p> <p>At a certain time for the solid BC runs, I get inflow at the dayside inner boundary, and a small pressure bump near the surface.</p> <p>The absorb BC, which is also used by <a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a> and <a href="https://doi.org/10.1002/2015JA021997">Tóth&#43;, 2016</a>, also gives wrong flow pattern on the flanks.</p> <p>The flow pattern issue is also present in some Cartesian grid ideal MHD runs, indicating that it has nothing to do with the grid geometry.</p> <p>Tests of different resistivity profiles &#40;\(\eta_{max}=5\times 10^{11}m^2/s\), \(\eta_{max}=8\times 10^{11}m^2/s\), \(\eta_{max}=3\times 10^{11}m^2/s\)&#41; shows that the whole flow pattern is not sensitive to \(\eta\mathbf{J}\). All runs show similar flow pattern in the equatorial plane: <em>there&#39;s a spurious return flow on the two sides at \(r=1\)</em>.</p> <p>I have repeatly confirmed that one quasi-steady solution with the given BC can convert to others by changing the inner BC setup.</p> <p>Besides, I have also tried to implement the insulating BC described in <a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a>. On a coarse grid, this BC gives pretty good magnetic field comparison. However, I gave it up later because I did not know how to make it work in parallel with the FFT computation.</p> <p>I always believe there are still inconsistencies in the boundary setup. None of the existing models provide a correct description of the inner boundary, and in fact how can believe that an MHD model can have an inner boundary that is actually the solid moon it self?</p> <p>I have an idea of half absorb half reflect U.</p> <h3 id=core_boundary_condition ><a href="#core_boundary_condition" class=header-anchor >Core boundary condition</a></h3> <p>At the core boundary, we only need to set magnetic field \(\mathbf{B}_1\). I used <code>fixedb1</code>/<code>fixedb1_semi</code> before. I should use <code>zerob1</code>.</p> <h2 id=solve_resisivity_numerically ><a href="#solve_resisivity_numerically" class=header-anchor >Solve Resisivity Numerically</a></h2> <p>For semi-implicit scheme, the larger \(\eta\) I use, I longer it will take for a certain number of timesteps. This means that larger resistivity gives stiffer problem to solve.</p> <p>One problem I encounter with <code>#SOLIDSTATE</code> at first is that the region \(r<rsolid\) never get updated. After a day of debugging, I found that this is due to the timestep calculation: when calculating timesteps, the mantle region is set to false cells, so the timestep there is 0. I am not sure what should I use for the implicit timestep.</p> <p>40000 steps in steady state run with \(\eta=3\times 10^{11}m^2/s\). From \(P_{max}\) .vs. timestep plot, I can see clear periodic oscillations indicating it is not converging. The streamline plot in \(y=0\) plane shows unphysical behavior near the pole region: it is too large, up to about 130km/s. The compare with Galileo still has an off-set for the magnetopause position.</p> <p>\(\eta=3\times 10^{11}m^2/s\) test: no spurious flow pattern in the equatorial plane at the sides; the Galileo comparison is ok. I realize one thing: the resistivity profile I use in <code>PARAM.in</code> starts from \(r=0.95\). This may have an influence on the results. I tried \(r=0.98\) for another test. Also, <a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a> uses \(\eta=1.6\times 10^{10}\text{m}^2/s\) at the surface. I also want to test that.</p> <p>Bad results. Even \(\eta=1\times 10^{11}\text{m}^2/s\) results in a small magnetosphere than Galileo observed. The even smaller \(\eta\) run is worse. However, if I turn on Hall MHD, the magnetosphere will expand.</p> <p>G8, \(\eta=0\) run. Physically, this is equivalent to a perfect conducting sphere with \(r=0.5R_G\)? No, not that easy. I get very small magnetosphere, the standoff distance is about 1.8, and the tail reconnection region center distance is about 2.5. This is consistent with my previous tests that the smaller the resistivity is, the smaller the magnetosphere is. However, when I check the \(b_1\) components in \(0.5<r<1\), something terrifying shows up: it is not zero&#33;&#33;&#33; This might be the problem&#33; I checked \(u\): it&#39;s always 0 in the mantle; I checked \(\eta\), it&#39;s also 0 in the mantle. My plan is to do local tests on this. First priority&#33; It is driving me crazy. The unit transformation is not easy. The run with solidBC and 0 resistivity gives wrong solutions. I wonder if this is due to the float OuterBC instead of fixed. Give it another try. The outer boundary is not the problem. The solution is completely wrong for this face inner boundary condition with 0 resistivity. By the way, I had an old run also with 0 resistivity. But the problem with that run is that the density inside is relatively small, therefore I got large Alfvén speed, which reduces the timestep inside so the solution may not converges.</p> <p>For the G8 run with cell inner boundary, I found that \(\eta=5\times 10^{11}m^2/s\) seemd to be a proper number.</p> <p>Checked my coarse grid runs with \(\eta=5\times10^{11}m^2/s\) for cell and face based solution for 750 steps. In general, they looked similar. There are differences, but I can&#39;t tell which one is correct simply from these variable comparisons.</p> <p>solid timestep \(0.5\times10^{-3}s\), \(\eta=3,2,1\times10^{11}m^2/s\). Pick the best fit, run for longer&#33;</p> <p>Still testing on the proper \(\eta\) value. \(1\times10^{11}m^2/s\) is not good; \(3\times10^{11}m^2/s\) gives slightly larger magnetopause.</p> <p>The face innerBC comparison of Hall MHD for G2 and G28 \(\eta=3\times10^{11}m^2/s\) are almost perfect. However, when I turned to PIC, the whole magnetosphere expands so I get much worse results...</p> <p>Checked the cell innerBC results with \(\eta=3,4,5\times10^{11}m^2/s\), and found that \(\eta=3\times10^{11}m^2/s\) is the best fit.</p> <p>Two <code>PARAM.in</code> files only differ in solid timestep: one used \(5^{-4}s\) and the other used \(1e^{-4}s\). The larger timestep run gives better comparison with Galileo data.</p> <p>Say we are solving \(\frac{\partial \mathbf{B}}{\partial t}=\eta\nabla^2\mathbf{B}\). The timestep limit requires that</p> \[ \Delta t < c\frac{\Delta x^2}{\eta} = c \frac{(0.02 R_G)^2}{3\times 10^{11}}\approx c \times 10^{-6}s \] <p>However, this is only true for the smallest cells inside the body&#33;</p> <p>Resistivity at the boundary cells is crucial in getting the correct solution&#33; We need to have at least 2 layers of 0 resistivity cells to produce the correct \(\mathbf{B}_1\) field around the core boundary. If the resistivity in the nearest physical cell is not 0, then even if the resistivity in the ghost cells are zero, the boundary face would have non-zero resistivity and corresponding non-zero electric field. This will give totally wrong behavior for the magnetic field topology.</p> <ul> <li><p>read two papers:</p> <ul> <li><p>one on Europa for the idea of induced magnetic field,</p> <li><p>another on Mercury for the property of resistivity.</p> </ul> </ul> <p>I found that the solidtimestep inside \(r=1\) is the reason for the wrong results: I picked a too large timestep \(10^{-2}\)s. Maybe some value around \(10^{-4}\)s is better.</p> <h3 id=better_inner_bc ><a href="#better_inner_bc" class=header-anchor >Better Inner BC</a></h3> <p>Source terms can be used to include physical processes that MHD would otherwise not model or to model sources or sinks of MHD quantities. Mass loading is the physical process in which newly created charged particles become part of an ambient plasma flow via electromagnetic forces. The processes of photoionization and electron impact ionization add new mass to the plasma, while charge exchange reactions may or may not add mass. Ionization creates an electronion pair — a source of new charge and mass for the plasma. Recombination acts as a sink of plasma in a similar way. Charge exchange on the other hand, exchanges a thermalized plasma ion with a neutral particle. In the process, mass may be added &#40;asymmetric charge&#41; or it may not &#40;symmetric charge exchange&#41;. An example of charge exchange which adds mass is the accidentally resonant charge exchange reaction between hydrogen and oxygen. The forward reaction of the \( H^+ + O \rightleftharpoons H + O^+ \) charge exchange process is a typical example of mass addition without creating new charge. An example of the special case of no new mass being added is the resonant charge exchange between atoms and their corresponding ions &#40;such as \( O^+ + O \rightleftharpoons O + O^+ \). In this case, there is neither new charge nor new mass added to the plasma, however the momentum and energy can change. The reaction results in a &quot;friction&quot; like force on the plasma as the ion moving with the plasma is replaced by a neutral at a different velocity. One can obtain the formulation of the source terms for MHD by starting with the Boltzmann equation &#91;e.g., Gombosi et al., 1996&#93;. Terms are formulated for this equation and then appropriate velocity moments are taken, resulting in the mass loading and friction source terms. The source vector &#40;in the conservative form of equation 2.18&#41; can be written as &#91;Gombosi et al., 1996: Combi et al.. 1998&#93;:</p> \[\begin{aligned} \mathbf{S}_n = \begin{pmatrix} \dot{\rho} \\ \dot{\rho}\mathbf{U}_n + \eta \rho (\mathbf{U}_n - \mathbf{U}) \\ 0 \\ \frac{1}{2}\dot{\rho}\mathbf{U}_n^2 + \eta [\frac{1}{2}\rho (\mathbf{U}_n^2 - \mathbf{U}^2) + \frac{1}{\gamma-1}P] \end{pmatrix} - L_e \begin{pmatrix} \rho \\ \rho \mathbf{U} \\ 0 \\ \frac{1}{2}\rho\mathbf{U}^2 + \frac{1}{\gamma - 1}P \end{pmatrix} \end{aligned}\] <p>where \(\dot{\rho}\) is the net mass addition rate &#40;production minus loss due to ionization and charge exchange&#41;, \(\eta\) is the coefficient of frictional interaction between the plasma and the neutral gas due to charge exchange reactions and \(L_e\) is the coefficient associated with electron recombination. Note that in the first bracket the first term in each line is associated with mass addition &#40;ionization and charge exchange&#41; and the second is due to friction &#40;charge exchange&#41;. The second bracket represents the loss terms associated with recombination.</p> <p>It is interesting to examine the first term &#40;associated with mass addition due to ionization and charge exchange&#41; in both the conservative and the primitive forms. Table below shows the terms in the momentum, pressure and energy equations for mass loading where the velocity of the ionized neutrals is zero. From the conservative form it is clear what change the total momentum and energy of the plasma undergo. With the neutral at rest the neutral has no momentum and no energy that it can add to the plasma when it is ionized. The primitive form of the momentum equation shows that while the plasma momentum is conserved, the mass addition must be offset by a decrease in the plasma velocity. This process heats the plasma as seen by the source term in the pressure equation.</p> <p>Ionization source terms in primitive and conservative form:</p> <table><tr><th align=center >Equation<th align=center >Primitive Form<th align=center >Conservative Form<tr><td align=center >Momentum<td align=center >\(-\dot{\rho}\mathbf{U}\)<td align=center >0<tr><td align=center >Pressure<td align=center >\(-\frac{1}{2}\dot{\rho}\mathbf{U}\)<td align=center >-<tr><td align=center >Energy<td align=center >-<td align=center >0</table> <p>Mass loading/loss:</p> <ul> <li><p><strong>photo-ionization</strong></p> <li><p><strong>dissociative recombination</strong></p> <li><p><strong>electron impact</strong></p> </ul> <p>I have found the recombination process in <code>UserSaturn</code>, impact ionization, charge exchange and recombination in <code>UserMars</code>. For Mars, there are currently a 4 species module and a 5 fluids &#43; Pe module. The latter is inherited from the former one.</p> <p>What I have in mind is similar to what&#39;s been described in <a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a>. From a modeling perspective, we need to specify the \(O_2\) number density distribution, calculate the production rate, loss rate and collision frequency according to the formulas, and then add to the mass and momentum equations.</p> <p>As a starting point, I can use a hydrostatic assumption for the neutral atmosphere, with uniformly distributed \(O_2\). If I believe that a denser atmosphere is true from <a href="https://doi.org/10.1016/j.icarus.2020.113691">Carnielli&#43;, 2020</a> and use a column density \(N_n = 2.44\times10^{15}\, \text{cm}^{−2}\) and scale height \(H = 250\) km, then</p> \[ n_{n,0} = N_n / H = 9.8\times10^{13} \text{m}^{−3}. \] <p>From <a href="https://doi.org/10.1029/2019JA026787">Yash&#39;s Jupiter paper</a>,</p> \[ \dot{\rho} = 16 m_p n_n C_i\] <p>where \(C_i\) is the ionization rate &#40;specified to \(10^{−4} \text{s}^{−1}\) in the simulations&#41; and 16 amu is taken to be the average mass of the heavy ions present in Jupiter&#39;s magnetosphere.</p> <p>The source terms for the mass continuity, momentum, total energy and thermal energy equations &#40;Hansen, 2001&#41;:</p> \[\begin{aligned} S_\rho &= \dot{\rho} - \alpha_\text{rec}\rho \\ \mathbf{S}_{\rho U} &= \dot{\rho}\mathbf{U}_{n} + C_\text{ex}\mathbf{U}_{n} - (C_\text{ex}+\alpha_\text{rec})\rho \mathbf{U} \\ S_E &= \frac{1}{2}(\dot{\rho} + C_\text{ex}\rho)\mathbf{U}_{n}^2 - \frac{1}{2}\rho \mathbf{U}^2 (C_\text{ex} - \alpha_\text{rec}) - \frac{3}{2}\alpha_\text{rec}p + \frac{3}{2}C_\text{ex}p \\ S_P &= \frac{1}{2}(\dot{\rho} + C_\text{ex}\rho)|\mathbf{U} - \mathbf{U}_{n}|^2 - \frac{3}{2}\alpha_\text{rec}p \end{aligned}\] <p>where \(C_\text{ex}\) is the charge-exchange rate, \(\mathbf{U}_n\) is the Keplerian velocity of neutral particles orbiting Jupiter, and \(\alpha_\text{rec}\) is the recombination rate, which is set to 0.<sup id="fnref:3"><a href="#fndef:3" class=fnref >[3]</a></sup> <sup id="fnref:4"><a href="#fndef:4" class=fnref >[4]</a></sup> <sup id="fnref:5"><a href="#fndef:5" class=fnref >[5]</a></sup></p> <p><table class=fndef  id="fndef:3"> <tr> <td class=fndef-backref ><a href="#fnref:3">[3]</a> <td class=fndef-content >The mass and momentum equations are consistent with K.C.Hansen&#39;s thesis. The energy equation in Yash&#39;s paper is wrong, but the pressure equation is probably correct. </table> <table class=fndef  id="fndef:4"> <tr> <td class=fndef-backref ><a href="#fnref:4">[4]</a> <td class=fndef-content >Initially I made many mistakes on the velocity. I don&#39;t quite understand the terms especially in the pressure equation: why does it look like a source term? </table> <table class=fndef  id="fndef:5"> <tr> <td class=fndef-backref ><a href="#fnref:5">[5]</a> <td class=fndef-content >\(C_\text{ex}\) is the same as \(\eta\) in K.C&#39;s thesis; \(\alpha_\text{rec}\) is the same as \(L_e\). </table> </p> \[\begin{aligned} \nu_\text{ion} &= 2.2 \times 10^{-8}\, &[\text{s}^{-1}] \\ n_{n,0} &= 9.8 \times 10^{13}\, &[\text{m}^{-3}] \\ \alpha &= 7.8 \times 10^{-14}\, &[\text{m}^3 \text{s}] \\ M_\text{ion} &= 32 \, &[\text{amu}] \end{aligned}\] <p>In a steady state, when we equalize the production with loss, the plasma number density at the surface should be</p> \[ n_s = \sqrt{\frac{\nu_\text{ion}n_{n,0}}{\alpha}} \approx 5257\, \text{cm}^{-3}, \] <p>or, assuming all \(O_2^+\), the mass density will be \(1.7\times 10^5\,\text{amu}/\text{cc}\).</p> <p>This is very large compared to the previous fixed density \(550\) &#91;amu/cc&#93; in our runs, or the \(\sim 10^3\) &#91;amu/cc&#93; in both <a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a><sup id="fnref:6"><a href="#fndef:6" class=fnref >[6]</a></sup> and <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2016GL068363">Fatemi&#43;, 2018</a>.</p> <p><table class=fndef  id="fndef:6"> <tr> <td class=fndef-backref ><a href="#fnref:6">[6]</a> <td class=fndef-content >See the discussion and some of my opinion <a href="https://henry2004y.github.io/Ganymede/simulations_ganymede/#atmosphere_and_ionosphere">here</a>. </table> As an estimation, the source term in the mass equation gives</p> \[\begin{aligned} \dot{\rho} &= n_n(r) \nu_\text{ion} M_\text{ion} &= 9.8 \times 10^{13} \cdot 2.2 \times 10^{-8} \cdot 32\, [\text{amu}\cdot\text{m}^{-3}\text{s}^{-1}] &= 69\, [\text{amu}\cdot\text{cm}^{-3}\text{s}^{-1}] \end{aligned}\] <p>For the coarse grid run with about 0.3 million cells, the time step at the surface is on the order of \(10^{-2}\)s. For 1000 steps in local timestepping, the increase in density is about 700. This is very small compared to the expected value above. I have no idea how long it takes to reach equilibrium or will it ever reach equilibrium.</p> <p>After normalization, the unit for density is &#91;amu/cc&#93; and for velocity is &#91;R/s&#93;.</p> <p>For my specific problem, I need to have a feeling about the surface density, pressure and temperature in equilibrium. If I trust <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2016GL068363">Fatemi&#43;, 2018</a>&#39;s result, than it means that the thermal pressure does not matter much. Similar things may happen in <a href="https://doi.org/10.1002/2013JA019554">Duling&#43;, 2014</a>. According to my simple test, the upstream pressure has little influence on the magnetic field topology.</p> <p>Now that this is partly working, the next thing I would like to add is the term in the electron pressure equation. This may not matter much, but it would be better if I have those electron source/sink terms included.</p> <p>Single fluid description is clearly a deficiency here, but the question is: is it enough or do we need more complex physical description? In terms of overall magnetic field topology, this probably won&#39;t matter much; but is it crucial for energetic species near the moon? Use MHD just to simulate the thermal plasma background, and use PIC to get the energetic part done?</p> <h2 id=outer_bcs ><a href="#outer_bcs" class=header-anchor >Outer BCs</a></h2> <p>There are two types of outer boundary conditions: cell BC &#40;<code>#OUTERBOUNDARY</code>&#41; and face BC &#40;<code>#BOXBOUNDARY</code>&#41;.</p> <h2 id=local_timestepping_vs_time-accurate ><a href="#local_timestepping_vs_time-accurate" class=header-anchor >Local Timestepping .vs. Time-accurate</a></h2> <p>I found that the local timestepping mode gives smaller magnetosphere than the time-accurate mode. There&#39;s no true steady state, especially after the inclusion of Hall MHD, and the detailed shape of the magnetopause is changing constantly.</p> <h2 id=mhd_vs_pic ><a href="#mhd_vs_pic" class=header-anchor >MHD .vs. PIC</a></h2> <p>In general, PIC gives smoother results than MHD in MHD quantities, with/without extra artificial smoothing in PIC. The reason we have E field smoothing is to reduce the noise in the particle solutions.</p> <h2 id=pc_scheme ><a href="#pc_scheme" class=header-anchor >PC Scheme</a></h2> <p>After a bunch of tests, we found that the original implicit PIC scheme is noisy especially in electric field, and it would create numerical waves inside the magnetosphere. We suspected that it owed to the fact that neither the momentum nor the energy is conserved. This is why we switched to the new energy and charge conserving scheme in the next step.</p> <h2 id=speed_of_light ><a href="#speed_of_light" class=header-anchor >Speed of Light</a></h2> <p>In G8 PIC simulation, electron thermal velocity &#40;\(uxs0,uys0,uzs0\)&#41; in certain regions is larger than the speed of light &#40;1000km/s&#41; I set in the iPIC simulation. The code can still run, but this is usually a sign of error. Throughout the 600s, the velocity profile is, to me, very steady. There are some noise in the upstream region &#40;left&#41;, but I think it&#39;s fine.</p> <p>When I increase the speed of light from 1000km/s to 2000km/s, I can see more FTEs&#33;</p> <h2 id=g2 ><a href="#g2" class=header-anchor >G2</a></h2> <p>G2 velocity plot shows much larger velocity components than the hydrogen ion observation. It is strange that the heavy ion observation inside the magnetosphere is missing. There is estimation in William&#39;s paper for the maximum ion velocity inside the magnetosphere for G2, which is about \(25 \sim 45\) km/s.</p> <h2 id=g29 ><a href="#g29" class=header-anchor >G29</a></h2> <p>For the G29 flyby, I get a shift in B for the trajectory comparison, same as Xianzhe&#39;s previous model, but different from &#91;Duling&#43; 2014&#93; and the hybrid model from Berkeley.</p> <p>G29 time shift, try adding a negative Vy &#40;e.g. -30km/s&#41; to see if there&#39;s any shift.</p> <h2 id=gmpc_coupling ><a href="#gmpc_coupling" class=header-anchor >GM/PC Coupling</a></h2> <p>I went through the commands of GM-PC coupling with Yuxi. Now it seems to work. I need to go over the commands again and ask Yuxi to complete the PARAM.XML. Take notes&#33;</p> <p>Steps towards GM/PC coupling:</p> <p>In SWMF,</p> <ul> <li><p><code>#COUPLE2</code>: this command determines the master component and the slave component. Dncouple is the step interval for coupling, and Dtcouple is the time interval for coupling. I discussed with Yuxi about the time interval coupling option: this means that if the physical time of either component exceeds Dtcouple, then it&#39;s time to do the coupling. The problem here might be that the coupling may happen not exactly at the same physical time.</p> <li><p><code>#COUPLETIME</code>: Together with the prior command, this determines if the chosen component does the coupling at exact the same time. For example, say your timestep for PC is 0.1s, and DtCouple in the prior command is set to 0.51s. Then the coupling time must be 0.51s, so the \(6^{th}\) step in PC can only advance in 0.1s.</p> </ul> <p>This command is usually used for both components.</p> <p>In GM,</p> <ul> <li><p><code>#PICUNIT</code>: define the length and velocity units for the PIC model.</p> <li><p><code>#PICREGION</code>: define the number, location, and grid resolution for iPIC3D.</p> </ul> <p>In PC,</p> <ul> <li><p><code>#TIMESTEPPING</code>: determine if to use SWMFDt or not, if to use fixedDt or not, and a suitable CFL number for PIC advancing. According to Yuxi, this is similar to CFL number in solving PDEs, but slightly different. Theoretically, implicit PIC is unconditionally stable, but there is still a restriction from the accuracy requirement:</p> </ul> \[ \Delta t< v_{th}/\Delta x. \] <p>Stefano said right now implicit PIC can have \(10\) times larger timestep than explicit PIC.</p> <ul> <li><p><code>#PROCESSORS</code>: determine how many processors are allocated in each dimension. This is useful in restart mode, because you need to use the same number of processsors as before. Another constraint is that the number of particles per processor must be larger than 1, which means you cannot allocate too many processors in one direction.</p> <li><p><code>#RESTART</code>: Turn this on if you are in the restart mode.</p> <li><p><code>#ELECTRON</code>: define the charge/mass ratio used in PIC. This is related to the gyroradius: we want to resolve the gyromotion, so we cannot bear a tiny gyroradius, therefore we artificially increase this ratio.</p> <li><p><code>#SMOOTHE</code>: determine how to smooth \(\mathbf{E}, \mathbf{J}\) and \(\rho^\ast\). Special treatment with the boundary cells with a linear changing factor from InnerSmoothFactor to BoundarySmoothFactor in nBoundarySmooth. If BoundarySmoothFactor is larger than 1, then it will be cut-off to 1. The smoothing algorithm is:</p> </ul> \[ E_{ijk}^{\prime}=\alpha E_{ijk}+\frac{1-\alpha}{6}\sum{(\text{six neighbors of } E_{ijk})}, \] <p>and this will be done iteratively nSmooth times.</p> <ul> <li><p><code>#POISSON</code>: determine if the correction of \(\nabla\cdot\mathbf{E}=\rho^\ast\) is needed and the timestep interval for doing this.</p> <li><p><code>#PARTICLES</code>: determine the number of particles per cell</p> <li><p><code>#DISCRETIZATION</code>: control the parameters in the discretization scheme. The important one is <code>theta</code>. Theoretically, a value of 0.5 implies semi-implicit exact energy conservation and 1.0 implies fully-implicit. Yuxi said a value of 0.51 gave better stability in practice.</p> <li><p><code>#SOLVER</code>: define the tolerances and iterations for implicit solvers. I think these are empirical choices.</p> <li><p><code>#SAVEIDL</code>: save idl output files</p> <li><p><code>#SAVEPLOT</code>: save hdf5 output files</p> </ul> <p>We agreed to run with 1 PIC region, with the correct electron charge mass ratio, maybe without smoothing and try to separate electron pressure equation in MHD solution.</p> <p>I checked my PIC results for the continued time accurate run of face based steady state solution. Now it is more dynamic than before. The only difference is the ion electron mass ratio: previous one is 1400 while this one is 100. As Gabor told me, this will influence whether or not we can resolve the electron scale length. Read the part of Gabor&#39;s paper discussing about this.</p> <p>The G28 Hall MHD face InnerBC comparison is good, but not perfect. I get slightly larger \(B_x\) and smaller \(B_z\). I think it is good enough. The result of G2 is very close to pure dipole for \(B_y, B_z\) and \(B_{tot}\). My G2 Hall MHD with face-based InnerBC is terrible... I don&#39;t know why. I suspect there&#39;s something wrong with my setup. Check the parameter file later.</p> <p>Checked the PIC results with ion/electron mass ratio 100 for 600s. In the first 100s, it is very dynamic on the dayside magnetopause; after that, it is, to some extent, very quite. Yuxi told me this might be expected last week.</p> <p>I looked at Gabor&#39;s run66 y&#61;0.outs. In this run he had 4 four PIC regions, of which the one on the dayside is larger than mine. I can see FTEs up to about \(400s\).</p> <p>I doubt that this difference is due to smoothing. It is too much diffusive, maybe. I will try to turn off smoothing and see if I can get FTEs for a longer time.</p> <p>The magnetic field comparison is not so good. The magnetopause expands farther out. I have another run with no update check and coarse axis to increase the MHD timestep. Again, it showed an expansion of the magnetopause.</p> <p>You should be clear of the goal of this project. This simulation is to aim to show the robustness and complexity of MHD-EPIC coupling with all kinds of tricks and schemes.</p> <h3 id=charge-mass_ratio ><a href="#charge-mass_ratio" class=header-anchor >Charge-mass ratio</a></h3> <p><code>#PLASMA</code>, <code>#HALL</code>, <code>#ELECTRON</code>. For the coupling between Hall MHD and PIC, we need to set the electron charge/mass ratio. As in our case here for Ganymede, the average ion mass we use is 14 amu. We need to make sure that the actual electron/ion mass ratio is 1/100 instead of 14/100. This can be achieved with <code>#SOLARWIND</code> density 56, plasma ratio 1 and hall factor 1. After talking to Gabor, I realize that it is more natural to change <code>#ELECTRON</code> to -100/14.</p> <h3 id=observation_on_the_first_coupled_run ><a href="#observation_on_the_first_coupled_run" class=header-anchor >Observation on the first coupled run</a></h3> <p>FTEs, EM fields, FFT of B.</p> <p>In PC solution:</p> <ul> <li><p>\(B_x,B_y,B_z\): they change little during the run, but the overall contour shifted upwards a little bit. \(B_y\) is what they call Hall magnetic field with a quadrupole configuration.</p> <li><p>\(E_x,E_y,E_z\): \(E_x\) is positive on the upstream side and negative on the downstream side; \(E_y\) is very noisy; \(E_z\) is very boring with most of the part \(0\) and nonzero in a line near the cusp region.</p> <li><p>\(ps0,ps1\): very noisy, indeed, comparing to pure MHD solutions.</p> <li><p>FTEs: one thing I am thinking about is whether the \(1s\) output resolution can fully capture the FTEs. In \(100s\sim500s\), to be honest, I only see one very typical FTE at 235s. If I zoom in, 121s,216s,228s,234s,235s,241s,297s,298s.</p> </ul> <p>In GM solution:</p> <ul> <li><p>\(z=0\) cut, \(p; ux;uy\): \(368s\) a huge flux rope on sub-Jovian flank; \(403s\) pressure pulse/release in the tail?; very strange vortexes in \(x\in[-0.5,0.5],y\in[-1.5,-0.9]\), but the velocity is about \(30km/s\) &#40;very small&#41;; \(j\) in the tail at \(351s,401s\) looks like a energy release; \(|\nabla\cdot\mathbf{B}|\) and \(hyp\) pile up at the PIC box boundary, largest \(|\nabla\cdot\mathbf{B}|\) is about 1400.</p> <li><p>\(y=0\) cut: 424s very clear plasmoid in the tail, but this is not PIC result; almost nothing happens on the dayside, and you can hardly see FTEs; if I zoom in, I can see small FTEs at 181s,209s,216s,234s,235s,297s,298s. The overall configuration moves slightly inward.</p> </ul> <p>At the magnetopause, MHD resolution is about \(0.1R_G\), while PIC resolution is about \(0.03 R_G\).</p> <p>Gabor suggested that I looked at the Galileo Mag data and pick a reasonable Jovian wind B myself. The Jovian wind \(B_y\) I use is the same as shown in Margy&#39;s paper, but it seems to be unreasonable for the comparison. I totally agree. I need to run a new steady state solution and a PIC-coupled run based on that.</p> <h3 id=effect_of_pic_resolution ><a href="#effect_of_pic_resolution" class=header-anchor >Effect of PIC resolution</a></h3> <p>I want to emphasize the importance of grid resolution here: with enough resolution, even ideal MHD can generate flux ropes&#33; The key is the generation mechansim of reconnection and flux topes: Hall MHD already includes the important Hall resistivity besides numerical resistivity, and PIC model &#40;with enough resolution and particles&#41; literally includes everything. The GEM challenge more than 10 years ago showed that with enough resolution, Hall MHD can have similar reconnection rate compared with explicit PIC. Implicit PIC is quite different, in the sense that there&#39;s no constraint on the spatial resolution of Debye length for numerical stability, but we do need to explain what is going on for the under-resolved simulation. However, for our simulation right now, we do not fully resolve electron scales, which suggests the model should behave more or less like hybrid models. However, in reality things may not be that simple. What is the true relationship between these models?</p> <p>Response from Gabor:</p> <blockquote> <ul> <li><p>The electron motion is resolved, because particle positions are continuous. The electro-magnetic field is smooth over the grid cell, but the electron distribution function does not have to be smooth.</p> <li><p>Collisionless magnetic reconnection is due to the decoupling of electrons and the magnetic field, and one major driving force is the non-diagonal term in the electron pressure tensor. Neither of these are represented by hybrid codes, both of these are represented by implicit PIC codes, even if the grid is coarser than the electron skin depth.</p> <li><p>In hybrid codes the electrons are described as a massless charge neutralizing fluid. If the Hall term is kept in the induction equation, then the equations support whistler waves, which then requires an implicit solver or some other trick. So it is not really simpler than the implicit PIC method. If the Hall term is not included, then the hybrid scheme does not even have the Hall physics. So hybrid codes have the same issues as MHD codes with respect to reconnection: they rely on numerical diffusion. Implicit PIC relies on proper physics.</p> <li><p>We performed a grid convergence study for the GEM reconnection challenge with implicit PIC. See Figures 11 and 12 in <a href="https://doi.org/10.1016/j.jcp.2019.02.032">Yuxi’s 2019 paper</a>. As the grid resolution is degraded, some details get lost, but the overall reconnection physics is still properly captured. The coarsest grid has only 1 cell per electron skin depth, still the reconnection rate is correct, and the solution looks reasonable.</p> <li><p>The time steps and required grid resolution are very similar for hybrid and implicit PIC. The implicit PIC has more particles &#40;electrons&#41;, but otherwise the cost is quite comparable. So the argument that hybrid codes are much cheaper than implicit PIC is not true.</p> </ul> </blockquote> <p>Response from Stefano:</p> <blockquote> <ul> <li><p>I totally agree with Gabor. In addition to his comments, I would like to add that the implicit PIC still retains all the electron kinetic physics even when the simulation doesn’t resolve the electron scales. However, in such coarse configurations the dynamics of electrons is described at lower accuracy. That means that the length that we don’t resolve become equal to the grid spacing and frequency of wave we don’t resolved are compressed to the Nyquist frequency and damp with a rate that is proportional to the time step.</p> <li><p>While hybrid and implicit PIC might operate over the same spatial and time scale, implicit PIC still retain all the kinetic physics - it might though at low accuracy- while the hybrid can’t do only fluid description. In particular, fluid electrons can’t interact with waves &#40;heating, acceleration and instability&#41; making impossible to transfer energies between waves and particles. So there are very different when it comes to modeling capability.</p> </ul> </blockquote> <h2 id=comparison_between_g8_and_g28 ><a href="#comparison_between_g8_and_g28" class=header-anchor >Comparison Between G8 and G28</a></h2> <p>A partly conclusion from the comparison of G8 and G28 is that flux ropes tend to form under weak guide field condition. However, I realize that it is not very persuasive to draw the conclusion from the FFT of two different trajectory. Besides, the location of the strongest shear is different in these two different conditions, and the upstream density is also different.</p> <table><tr><th align=center >G8/G28<th align=center >\(|B|=87\)nT<th align=center >\(|B|=109\)nT<tr><td align=center >\(\rho=28\)amu/cc<td align=center >0.57<td align=center >0.25<tr><td align=center >\(\rho=56\)amu/cc<td align=center >0.48<td align=center >0.26</table> <table><tr><th align=center >Run<th align=center >\(B_x\)<th align=center >\(B_y\)<th align=center >\(B_z\)<th align=center >\(|B|\)<th align=center >\(\rho\)<th align=center >\(V\)<th align=center >\(V_A\)<th align=center >\(M_A\)<tr><td align=center >G8<td align=center >-10<td align=center >-6<td align=center >-86<td align=center >87<td align=center >56<td align=center >140<td align=center >253<td align=center >0.55<tr><td align=center >G28<td align=center >-7<td align=center >78<td align=center >76<td align=center >109<td align=center >28<td align=center >140<td align=center >450<td align=center >0.31<tr><td align=center >Mix1<td align=center >-10<td align=center >-6<td align=center >-86<td align=center >87<td align=center >28<td align=center >140<td align=center >358<td align=center >0.39<tr><td align=center >Mix2<td align=center >-7<td align=center >78<td align=center >76<td align=center >109<td align=center >56<td align=center >140<td align=center >318<td align=center >0.44</table> <p>Maybe I need additional runs for the same B magnitude but different orientations. This would tell you the importance of clock angle.</p> <h2 id=magnetopause ><a href="#magnetopause" class=header-anchor >Magnetopause</a></h2> <p>I tried to see the electron velocity from PIC outputs in the boundary normal coordinates. As expected, I get very small normal velocity component; however, the largest velocity seems not in the center of flux ropes, but on the edges&#33;</p> <h2 id=reconnection_ftes_and_flux_ropes ><a href="#reconnection_ftes_and_flux_ropes" class=header-anchor >Reconnection, FTEs and Flux Ropes</a></h2> <p>Quote from a magnetic reconnection paper by Sonnerup &#91;1981&#93;:</p> <blockquote> <p>First, reconnection can be defined in a manner that does not involve &#39;frozen fields&#39; or MHD terminology: reconnection occurs when an electric field is present along a magnetic separator &#40;X line, re-connection line&#41; in a plasma. Thus the fact that most theories of reconnection have used the MHD approach and associated language does not necessarily mean that the process exists only in the minds of those using the MHD approach. It can be discussed, albeit at some inconvenience, without the use of phrases such as &#39;moving field lines&#39; or &#39;magnetic flux transfer.&#39; The name &#39;reconnection&#39; itself does, of course, have it roots in the frozen field concept, but those who find it offensive may use the more innocuous term &#39;merging&#39; without creating communication difficulties.</p> </blockquote> <blockquote> <p>Second, we shall demonstrate that certain predictions of simple MHD reconnection models, specifically the occurence of plasma acceleration at the magnetopause, are borne out by the observations to be presented here.While these results by no means prove that MHD offers an adequate description of all aspects of magnetopause reconnection, &#40;it almost certainly does not&#41;, they, at least, demonstrated that MHD models can serve as an useful guide in the interpretation of certain basic magnetopause observations. The reason is that MHD, after all, is based on simple conservation laws, which have global validity even when MHD fails to provide an accurate description in certain narrow local regions, such as the interior of the magnetopause.</p> </blockquote> <p>Back to almost 40 years ago, people thought that magnetopause can be considered as either tangential discontinuity &#40;if there&#39;s no magnetic reconnection&#41; or rotational discontinuity. The difference between these two type is whether or not \(B_n=0\). Can I use this information to identify reconnection region on the magnetopause?</p> \[ \frac{B_n}{B} = \frac{v_n}{v_A} = M_{An}\sim 0.1 \] <p>There are three categories of magnetic reconnections: patchy, bursty, single/multiple X line. See references, for example, Core magnetic field enhancement in single X line, multiple X line and patchy reconnection, JGR, 1994. The common questions people asked are:</p> <ul> <li><p>Is their any flux tube coalescence with these various kinds of reconnection?</p> <li><p>What about the energy dissipation, \(\mathbf{j}\cdot\mathbf{E}>0\) ?</p> <li><p>Is current sheet related to FTE? Russell challenged the idea.</p> <li><p>Imperical London, small scale structure of flux ropes in Earth magnetotail: flux ropes, enhanced B, rotating orientation along satellite trajectory they can actually determine the size&#33; How did they do it? Enhanced electrostatic fluctuation, small scale enhancements in \(T_e\) associated with high-frequency B fluctuations, strong E field; electron scale vortex, signatured by an intense E field with a perpendicular current loop. idea: more energy in the system, more possibility for a vortex? vortex drift, electric potential associated with E vortex?</p> </ul> <p>I saw a new way of treating the Ohm&#39;s law: separate each one with mean and perturb term. However, the speaker faced a tough question of how to interpret negative perturbed viscosity term.</p> <h3 id=local_reconnection_rate ><a href="#local_reconnection_rate" class=header-anchor >Local reconnection rate</a></h3> <p>My first attempt to check the local reconnection rate failed. Many possible reasons:</p> <ul> <li><p>the way of capturing upstream conditions;</p> <li><p>the location of magnetopause;</p> <li><p>clock angle dependency;</p> <li><p>which formula to use.</p> </ul> <p>The electric field from PIC output is about one order magnitude higher than the expected reconnection electric field calculated from \(\rho\) and \(\mathbf{B}\). This may due to some other waves and instabilities &#40;e.g. low hybrid drifting waves&#41;.</p> <h3 id=analytical_estimation ><a href="#analytical_estimation" class=header-anchor >Analytical Estimation</a></h3> <p><a href="https://doi.org/10.1029/2019GL086228">Kaweeyanun&#43;2020</a> proposed a way to check the onset condition for reconnection on the upstream magnetopause with an analytical model. What is in agreement with us is that they found a large region on the magnetopause is valid for reconnection to happen. However, this analytical model cannot distinguish between different models of flux ropes, the field of which in general lacks fundamental theory.</p> <h2 id=potential_drop ><a href="#potential_drop" class=header-anchor >Potential Drop</a></h2> <p>I tried a new way of doing Potential drop calculation, with z&#61;2 cut and integrate along the magnetosphere boundary. When doing it in steady state, I can get a quite nice potential field; however, if I went into the time-accurate mode, for example t&#61;100s, I couldn&#39;t get 0 after integrating along the boundary to the starting point. One obvious explanation is that you don&#39;t have the potential field assumption in time-accurate runs: there&#39;s no guarantee that the flux coming in equals the flux coming out at the same time&#33;</p> <p>On average, the fluxes coming in should match the fluxes going out, such that the whole system is balanced. However, at a specific time you can either see more fluxes in or out.</p> <p>The FTEs are maybe cascading processes, meaning that there are flux ropes in large scales as well as in tiny scales. If so, this is difficult to do analysis.</p> <p>When I tried to compare the CPCP calculations from x&#61;0 cut and z&#61;2 box cut, I found some differences that shouldn&#39;t happen. If this is a deterministic system, then the results should be the same no matter how I do the restart runs.</p> <p>I compared the \(E_y\) line plots at t&#61;0s, t&#61;50s, t&#61;100s and t&#61;200s. The lines look similar, but not exactly the same. Some possible explanations are:</p> <ul> <li><p>interpolation interval is different;</p> <li><p><code>griddata</code> from scatter points uses a different algorithm.</p> </ul> <p>If we generate white noise and do the FFT of it, we get the same amplitude for each of the frequencies. Therefore, the output of the FFT of the noise follows approximately the power law FFT&#40;f&#41;&#61;\(m\frac{1}{f^\alpha}\) with \(\alpha=0\) and \(m\) a constant.</p> <p>On the other hand if we generate what is called as pink noise then \(\alpha=1\). There is also the case where we generate brown noise, that is noise generated through Brownian motion. As Brownian motion remembers its previous state, we can say that it has memory. In the case of Brown noise it can be checked that \(\alpha\approx 2\).</p> <h2 id=neutral_exchange_rates ><a href="#neutral_exchange_rates" class=header-anchor >Neutral Exchange Rates</a></h2> <p>Fran cares about the neutral exchange rates in the model. However, we only include this at Europa, but not Ganymede.</p> <h2 id=ulf_wave ><a href="#ulf_wave" class=header-anchor >ULF Wave</a></h2> <p>There is only one guy who ever worked on detecting wave signatures on Ganymede from Galileo observations. Quoted from one of his paper:</p> <blockquote> <p>Ganymede centered spherical coordinates, 3 min inside the magnetosphere, optimum for identification of resonant pulsations of magnetic field lines. Analysis of the spectrum of the three spherical components of the field revealed weak spectral peaks separated by constant intervals suggestive of resonant field line oscillation. Encouraged by this result, we proceeded to enhance the sharpness of the spectral peaks by using standard analysis technique.</p> </blockquote> <p>The Kelvin–Helmholtz instability is a favorite excitation mechanism for compressional fast mode waves at the magnetopause.</p> <p>K-H instability driven surface waves –&gt; mode conversion to Alfvén wave inside the magnetosphere?</p> <h2 id=kh_instability ><a href="#kh_instability" class=header-anchor >KH Instability</a></h2> <p>There are some interests in analyzing the K-H instability on the flanks of the magnetopause. Nawapat Kaweeyanun, the student of Adam Masters, also has a paper on this subject. From the plasma-moon interaction workshop discussion with him, we are still not so sure about the effect of multiple ion species and different energy levels.</p> <p>One big factor in the onset condition is the \(M/Q\) ratio. Since most of the heavy ions are O&#43; and S&#43;&#43;, both of which have \(M/Q=16\), it does not matter if we distinguish them or not. The linear K-H instability onset condition only relies on the bulk plasma properties. However, the linear growth rate, \(\gamma\), depends on the particle temperature. We know that in Ganymede&#39;s case the energetic particles contributes to most of the thermal pressures, despite the fact that the number densities are small compared to their cold bulk brothers. Currently I am not clear about the exact expression of the dependence of \(\gamma\) on velocity/energy/pressure/density, but definitely a strict theory requires the relation of these basic factors other than temperature. In my point of view, temperature is such an ambiguous quantity that is almost meaningless in space. When people talk about energetic particles, they use energies in eV.</p> <p></p> <div class=page-foot > <div class=copyright > &copy; Hongyang Zhou. Last modified: September 17, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>. </div> </div> </div> </div> <script src="/Ganymede/libs/katex/katex.min.js"></script> <script src="/Ganymede/libs/katex/auto-render.min.js"></script> <script>renderMathInElement(document.body)</script>